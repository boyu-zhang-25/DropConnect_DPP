device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_83_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  0.6384799337107596
Sum of diagonals:  1.4574058137937445
Sum of diagonals:  1.381356383895831
Sum of diagonals:  0.7196940390184974
Sum of diagonals:  1.455599537017926
Sum of diagonals:  1.4393708295633512
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 83
unpruned MLP avg. test loss: 0.051438494996759405
Tested Masks: [20/100]	Avg. Loss: 5.066250	
Tested Masks: [40/100]	Avg. Loss: 4.944710	
Tested Masks: [60/100]	Avg. Loss: 4.912284	
Tested Masks: [80/100]	Avg. Loss: 4.878534	
pruned MLP avg. test loss: 2.4049702861109696
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_166_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  0.6384799337107596
Sum of diagonals:  1.4574058137937445
Sum of diagonals:  1.381356383895831
Sum of diagonals:  0.7196940390184974
Sum of diagonals:  1.455599537017926
Sum of diagonals:  1.4393708295633512
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 166
unpruned MLP avg. test loss: 0.051438494996759405
Tested Masks: [20/100]	Avg. Loss: 2.592770	
Tested Masks: [40/100]	Avg. Loss: 2.534227	
Tested Masks: [60/100]	Avg. Loss: 2.516340	
Tested Masks: [80/100]	Avg. Loss: 2.499982	
pruned MLP avg. test loss: 1.2388582296742623
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_250_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  0.6384799337107596
Sum of diagonals:  1.4574058137937445
Sum of diagonals:  1.381356383895831
Sum of diagonals:  0.7196940390184974
Sum of diagonals:  1.455599537017926
Sum of diagonals:  1.4393708295633512
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 250
unpruned MLP avg. test loss: 0.051438494996759405
Tested Masks: [20/100]	Avg. Loss: 1.234009	
Tested Masks: [40/100]	Avg. Loss: 1.208255	
Tested Masks: [60/100]	Avg. Loss: 1.205066	
Tested Masks: [80/100]	Avg. Loss: 1.200411	
pruned MLP avg. test loss: 0.5919916488032752
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_333_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  0.6384799337107596
Sum of diagonals:  1.4574058137937445
Sum of diagonals:  1.381356383895831
Sum of diagonals:  0.7196940390184974
Sum of diagonals:  1.455599537017926
Sum of diagonals:  1.4393708295633512
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 333
unpruned MLP avg. test loss: 0.051438494996759405
Tested Masks: [20/100]	Avg. Loss: 0.513677	
Tested Masks: [40/100]	Avg. Loss: 0.497138	
Tested Masks: [60/100]	Avg. Loss: 0.492884	
Tested Masks: [80/100]	Avg. Loss: 0.489130	
pruned MLP avg. test loss: 0.24117798538102686
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_417_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  0.6384799337107596
Sum of diagonals:  1.4574058137937445
Sum of diagonals:  1.381356383895831
Sum of diagonals:  0.7196940390184974
Sum of diagonals:  1.455599537017926
Sum of diagonals:  1.4393708295633512
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 417
unpruned MLP avg. test loss: 0.051438494996759405
Tested Masks: [20/100]	Avg. Loss: 0.151716	
Tested Masks: [40/100]	Avg. Loss: 0.146284	
Tested Masks: [60/100]	Avg. Loss: 0.144778	
Tested Masks: [80/100]	Avg. Loss: 0.144098	
pruned MLP avg. test loss: 0.07132099410126362
