device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_83_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  1.6790139560018815
Sum of diagonals:  2.1749547117733385
Sum of diagonals:  1.9650700658174287
Sum of diagonals:  1.8557028388541976
Sum of diagonals:  1.944207462702849
Sum of diagonals:  2.199904875975733
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 83
unpruned MLP avg. test loss: 0.24108643275638883
Tested Masks: [20/100]	Avg. Loss: 4.999845	
Tested Masks: [40/100]	Avg. Loss: 4.907674	
Tested Masks: [60/100]	Avg. Loss: 4.895228	
Tested Masks: [80/100]	Avg. Loss: 4.877923	
pruned MLP avg. test loss: 2.405658503376488
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_166_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  1.6790139560018815
Sum of diagonals:  2.1749547117733385
Sum of diagonals:  1.9650700658174287
Sum of diagonals:  1.8557028388541976
Sum of diagonals:  1.944207462702849
Sum of diagonals:  2.199904875975733
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 166
unpruned MLP avg. test loss: 0.24108643275638883
Tested Masks: [20/100]	Avg. Loss: 2.576346	
Tested Masks: [40/100]	Avg. Loss: 2.511085	
Tested Masks: [60/100]	Avg. Loss: 2.487877	
Tested Masks: [80/100]	Avg. Loss: 2.475340	
pruned MLP avg. test loss: 1.2269967723062878
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_250_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  1.6790139560018815
Sum of diagonals:  2.1749547117733385
Sum of diagonals:  1.9650700658174287
Sum of diagonals:  1.8557028388541976
Sum of diagonals:  1.944207462702849
Sum of diagonals:  2.199904875975733
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 250
unpruned MLP avg. test loss: 0.24108643275638883
Tested Masks: [20/100]	Avg. Loss: 1.262378	
Tested Masks: [40/100]	Avg. Loss: 1.244582	
Tested Masks: [60/100]	Avg. Loss: 1.231552	
Tested Masks: [80/100]	Avg. Loss: 1.223755	
pruned MLP avg. test loss: 0.605703060550723
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_333_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  1.6790139560018815
Sum of diagonals:  2.1749547117733385
Sum of diagonals:  1.9650700658174287
Sum of diagonals:  1.8557028388541976
Sum of diagonals:  1.944207462702849
Sum of diagonals:  2.199904875975733
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 333
unpruned MLP avg. test loss: 0.24108643275638883
Tested Masks: [20/100]	Avg. Loss: 0.627599	
Tested Masks: [40/100]	Avg. Loss: 0.612794	
Tested Masks: [60/100]	Avg. Loss: 0.606441	
Tested Masks: [80/100]	Avg. Loss: 0.604465	
pruned MLP avg. test loss: 0.29873234226047385
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Pruning started!
original_w1 size (500, 6)
input size (800000, 500)
creating weight...
input.shape: (800000, 500), weight.T.shape: (6, 500), (weight.T)[:,np.newaxis].shape: (6, 1, 500)
weighted_input_mat.shape: (6, 800000, 500)
created kernel student_6_w1_417_ker_list.pkl
dpp_edge mask_list length: 100 each mask shape: (500, 6)
Shape of Kernel List:  (6, 500, 500)
Sum of diagonals:  1.6790139560018815
Sum of diagonals:  2.1749547117733385
Sum of diagonals:  1.9650700658174287
Sum of diagonals:  1.8557028388541976
Sum of diagonals:  1.944207462702849
Sum of diagonals:  2.199904875975733
device cpu
two-layer FFNN (DO NOT freeze student w2)
two-layers NN!
Testing: dpp_edge 
student hidden size: 6 
k: 417
unpruned MLP avg. test loss: 0.24108643275638883
Tested Masks: [20/100]	Avg. Loss: 0.329372	
Tested Masks: [40/100]	Avg. Loss: 0.324410	
Tested Masks: [60/100]	Avg. Loss: 0.321340	
Tested Masks: [80/100]	Avg. Loss: 0.319633	
pruned MLP avg. test loss: 0.15818016358609568
